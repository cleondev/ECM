<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Login Azure · ECM</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;600&family=Oxanium:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            color-scheme: dark;
            font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            --bg-gradient: radial-gradient(circle at 15% 20%, rgba(56, 189, 248, 0.25), transparent 60%),
                             radial-gradient(circle at 80% 0%, rgba(244, 114, 182, 0.25), transparent 55%),
                             linear-gradient(135deg, #05020f 0%, #0a1b2e 40%, #05051a 100%);
            --panel: rgba(10, 20, 40, 0.82);
            --border: rgba(56, 189, 248, 0.25);
            --azure: #0078d4;
            color: #e0f2fe;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: clamp(1.5rem, 4vw, 3.5rem);
            background: var(--bg-gradient);
            overflow: hidden;
        }

        .grid-overlay {
            position: fixed;
            inset: 0;
            pointer-events: none;
            background-image: linear-gradient(rgba(56, 189, 248, 0.06) 1px, transparent 1px),
                              linear-gradient(90deg, rgba(56, 189, 248, 0.06) 1px, transparent 1px);
            background-size: 90px 90px;
            transform: perspective(1100px) rotateX(55deg) translateY(8%);
            opacity: 0.75;
            mix-blend-mode: screen;
        }

        main {
            position: relative;
            width: min(1080px, 100%);
            padding: clamp(2rem, 5vw, 4rem);
            border-radius: 28px;
            background: var(--panel);
            border: 1px solid var(--border);
            box-shadow: 0 45px 120px rgba(37, 99, 235, 0.25);
            overflow: hidden;
        }

        main::before {
            content: "";
            position: absolute;
            inset: -120px -40px;
            background: conic-gradient(from 200deg at 70% 40%, rgba(56, 189, 248, 0.16), transparent 45%, rgba(244, 114, 182, 0.2));
            filter: blur(120px);
            opacity: 0.9;
            z-index: 0;
        }

        .frame {
            position: relative;
            z-index: 1;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: clamp(2rem, 4vw, 3.5rem);
        }

        .intro {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .badge {
            align-self: flex-start;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.45rem 1rem;
            border-radius: 999px;
            background: rgba(56, 189, 248, 0.15);
            color: rgba(56, 189, 248, 0.95);
            font-size: 0.8rem;
            letter-spacing: 0.08em;
            text-transform: uppercase;
        }

        h1 {
            margin: 0;
            font-family: 'Oxanium', sans-serif;
            font-size: clamp(2.35rem, 5vw, 3.2rem);
            letter-spacing: 0.06em;
            text-transform: uppercase;
            color: #7dd3fc;
            text-shadow: 0 0 25px rgba(56, 189, 248, 0.45);
        }

        .intro p {
            margin: 0;
            font-size: 1.05rem;
            line-height: 1.7;
            color: rgba(224, 242, 254, 0.82);
        }

        .intro ul {
            margin: 0;
            padding: 0;
            list-style: none;
            display: grid;
            gap: 0.85rem;
        }

        .intro li {
            position: relative;
            padding-left: 1.75rem;
            color: rgba(224, 242, 254, 0.78);
            line-height: 1.6;
        }

        .intro li::before {
            content: "";
            position: absolute;
            left: 0;
            top: 0.55rem;
            width: 0.75rem;
            height: 0.75rem;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(56, 189, 248, 0.9), rgba(244, 114, 182, 0.9));
            box-shadow: 0 0 15px rgba(56, 189, 248, 0.55);
        }

        .login-card {
            align-self: center;
            padding: clamp(1.75rem, 4vw, 2.5rem);
            border-radius: 24px;
            border: 1px solid rgba(56, 189, 248, 0.15);
            background: rgba(4, 13, 27, 0.88);
            display: grid;
            gap: 1.5rem;
        }

        .logo-chip {
            display: inline-flex;
            align-items: center;
            gap: 0.6rem;
            padding: 0.5rem 1rem;
            border-radius: 999px;
            background: rgba(14, 165, 233, 0.15);
            border: 1px solid rgba(56, 189, 248, 0.2);
            font-weight: 600;
            letter-spacing: 0.04em;
            color: rgba(125, 211, 252, 0.95);
        }

        .login-title {
            margin: 0;
            font-size: 1.6rem;
            font-weight: 600;
            color: #f8fafc;
        }

        .login-subtitle {
            margin: 0;
            color: rgba(148, 163, 184, 0.9);
            line-height: 1.6;
        }

        button {
            font-family: inherit;
            font-weight: 600;
            font-size: 1rem;
            padding: 1rem 1.4rem;
            border-radius: 16px;
            border: none;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
        }

        button:disabled {
            cursor: progress;
        }

        .azure-button {
            background: linear-gradient(135deg, var(--azure), #9333ea);
            color: #f8fafc;
            box-shadow: 0 20px 40px rgba(37, 99, 235, 0.35);
            border: 1px solid rgba(96, 165, 250, 0.35);
        }

        .azure-button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 25px 45px rgba(37, 99, 235, 0.45);
        }

        .azure-button svg {
            width: 1.2rem;
            height: 1.2rem;
        }

        .alt-links {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            font-size: 0.9rem;
            color: rgba(148, 163, 184, 0.8);
        }

        .alt-links a {
            color: rgba(125, 211, 252, 0.95);
            text-decoration: none;
        }

        .alt-links a:hover {
            text-decoration: underline;
        }

        .alt-links a[aria-disabled="true"] {
            opacity: 0.45;
            pointer-events: none;
        }

        .status-panel {
            font-family: 'JetBrains Mono', 'Fira Code', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            background: rgba(2, 8, 23, 0.85);
            border-radius: 16px;
            border: 1px solid rgba(56, 189, 248, 0.18);
            padding: 1rem 1.25rem;
            color: rgba(148, 163, 184, 0.9);
        }

        @media (max-width: 720px) {
            body {
                padding: 1.25rem;
            }

            main {
                padding: 1.75rem;
            }

            .login-card {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="grid-overlay" aria-hidden="true"></div>
    <main>
        <div class="frame">
            <section class="intro">
                <span class="badge">ECM · Single Sign-On</span>
                <h1>Đăng nhập Azure</h1>
                <p>
                    Tham gia không gian làm việc ECM của bạn thông qua Azure Active Directory với giao diện cyberpunk hiện đại.
                    Việc xác thực được bảo vệ bởi bảo mật của Microsoft và chỉ mất vài giây để hoàn tất.
                </p>
                <ul>
                    <li>Chọn đúng tài khoản doanh nghiệp hoặc trường học của bạn trong bước đăng nhập Microsoft.</li>
                    <li>Hệ thống tự động ánh xạ quyền truy cập dựa trên nhóm và vai trò Azure AD.</li>
                    <li>Phiên đăng nhập được mã hóa và theo dõi theo chuẩn bảo mật nội bộ.</li>
                </ul>
            </section>
            <section class="login-card">
                <span class="logo-chip">ECM Secure Access</span>
                <h2 class="login-title">Login as Azure</h2>
                <p class="login-subtitle">Bấm nút bên dưới để chuyển hướng sang cổng đăng nhập Azure chính thức.</p>
                <button id="azure-login" class="azure-button">
                    <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                        <path fill="currentColor" d="M3.1 18.8L10.4 4.2c.25-.5.87-.5 1.12 0l7.36 14.6a.6.6 0 01-.54.87H14l-1.78-3.65a.6.6 0 00-.54-.35H8.13L6.34 19.7H3.64a.6.6 0 01-.54-.9z"></path>
                        <path fill="rgba(226, 232, 240, 0.9)" d="M12 6.2l-3.4 7.08h5.8L12 6.2z"></path>
                    </svg>
                    Đăng nhập với Azure
                </button>
                <div class="alt-links">
                    <span>Gặp sự cố?</span>
                    <a href="mailto:support@ecm.example.com">Liên hệ hỗ trợ</a>
                    <a href="#" aria-disabled="true">Chính sách bảo mật</a>
                </div>
                <div id="status" class="status-panel">Chưa bắt đầu quy trình đăng nhập.</div>
            </section>
        </div>
    </main>
    <script>
        const loginButton = document.getElementById('azure-login');
        const statusPanel = document.getElementById('status');

        const updateStatus = (text) => {
            statusPanel.textContent = text;
        };

        const fallbackRedirect = () => {
            window.location.href = '/signin-azure';
        };

        loginButton.addEventListener('click', async () => {
            loginButton.disabled = true;
            updateStatus('Đang chuẩn bị chuyển hướng sang Azure...');

            try {
                const response = await fetch('/api/auth/azure/login-url');

                if (response.ok) {
                    const data = await response.json();
                    if (data && data.url) {
                        updateStatus('Đã nhận URL đăng nhập, đang chuyển hướng...');
                        window.location.href = data.url;
                        return;
                    }
                }
            } catch (error) {
                console.error(error);
            }

            updateStatus('Chuyển sang cổng đăng nhập mặc định của Azure...');
            fallbackRedirect();
        });
    </script>
</body>
</html>
